function loadRecData(){(recordButton=document.getElementById("microphone_btn"),recordButton)&&(recordButton.addEventListener("click",startRecording),stopButton=document.getElementById("stopButton"),loader=document.getElementById("loader"),stopButton.style.display="none",stopButton.addEventListener("click",stopRecording))}function startRecording(){console.log("recordButton clicked");navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then(function(n){console.log("getUserMedia() success, stream created, initializing Recorder.js ...");audioContext=new AudioContext;gumStream=n;input=audioContext.createMediaStreamSource(n);rec=new Recorder(input,{numChannels:1});rec.record();console.log("Recording started")}).catch(function(){recordButton.style.display="flex";stopButton.style.display="none"});recordButton.style.display="none";stopButton.style.display="flex"}function stopRecording(){console.log("stopButton clicked");loader=document.getElementById("loader");$(loader).show();$(".loading").show();stopButton.style.display="none";recordButton.style.display="flex";rec.stop();gumStream.getAudioTracks()[0].stop();rec.exportWAV(createDownloadLink)}function createDownloadLink(n){var u=URL.createObjectURL(n),f=document.createElement("audio"),e=document.createElement("li"),r=(new Date).toISOString()+".wav",t=new XMLHttpRequest,i;t.onload=function(){var r;if(this.readyState===4){var u=JSON.parse(t.response)[0].body.split(";"),i="",n=$(".message-input .card-header").text();for(n&&(n=n.substring(0,n.length-1)),$(".loading").hide(),r=0;r<u.length;r++)i+=`<li class="from-me">`,n&&(i+=`<div class="card" data-id="`+(replyid?replyid:"")+`" >
                <div class="card-header">`+n+`</div>`),i+=`<label><div><audio controls src="/uploads/`+u[r]+`" ></audio></div><div> `+u[r]+`</div></label>`,n&&(i+=`<span>âœ“</span></div>`),i+=`</li>`;$(".loading").hide();$(".chat-pm-input textarea").val("");$("#lastchat").before(i);$(".img-tag").unbind("click");$(".img-tag").on("click",function(){var n=$(this).data("url");loadImageModal(n)});$("#Files").val("");$("#pogressbarModal").modal("hide");sendBySignalR(contactId,"isfile;;;"+userid+";;;"+result+",;,"+n+";;;;;;"+replyid);setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500);replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess();loader.style=""}};i=new FormData;i.append("audio_data",n,r);i.append("user",$(".contact.active").data("id"));t.open("POST","/Home/VoiceRecorder",!0);t.send(i)}URL=window.URL||window.webkitURL;var gumStream,rec,input,AudioContext=window.AudioContext||window.webkitAudioContext,audioContext,recordButton,stopButton,loader;