function _(e){return document.getElementById(e)}function uploadFile(e){$("#my-progress-bar").html("");var l=new XMLHttpRequest;l.upload.addEventListener("progress",progressHandler,!1),l.addEventListener("load",completeHandler,!1),l.addEventListener("error",errorHandlerUploader,!1),l.addEventListener("abort",abortHandler,!1),l.open("POST","/Home/UploadFiles"),l.send(e)}function progressHandler(e){var e=e.loaded/e.total*100,l=$("#my-progress-bar");0<l.length&&(l.get(0).style.width=Math.round(e)+"%",l.attr("aria-valuenow",Math.round(e)),l.html(Math.round(e)+"%"))}function completeHandler(e){fileUploadCompleted(e)}function errorHandlerUploader(){alertify("Upload Failed!!!")}function abortHandler(){alertify("Upload Aborted!!!")}function fileUploadCompleted(e){var l,i,a,o;try{console.log("fileUploadCompleted","start"),$("#tempProgressBar").remove(),$(".loading").hide(),console.log("fileUploadCompleted","result.target.response.split before"),e=e.target.response.split('"').join(""),console.log("fileUploadCompleted","result.target.response.split after");var t=e.split(";"),r="",d=(d=$(".message-input .card-header").text())&&d.substring(0,d.length-1);for(console.log("fileUploadCompleted","for (var i = 0; i < resArr before"),l=0;l<t.length;l++)r+='<li class="from-me">',d&&(r+='<div class="card" data-id="'+(replyid||"")+`" >
                    <div class="card-header">`+d+"</div>"),r+=IsImage(t[l])?'<label><a data-url="/Home/GetFile?fileName='+t[l]+'&fileType=up" class="img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName='+t[l]+'&fileType=up&th=true" /></div><div>'+SimpleFileName(t[l])+"</div></a></label>":IsAudio(t[l])?'<label><div><audio controls src="/Home/GetFile?fileName='+t[l]+'&fileType=up" ></audio></div><div> '+SimpleFileName(t[l])+"</div></label>":IsVideo(t[l])?'<label><div><video controls  ><source src="/Home/GetFile?fileName='+t[l]+'&fileType=up" ></video></div><div> '+SimpleFileName(t[l])+"</div></label>":IsPdfOrDoc(t[l])?'<label><a href="/Home/GetFile?fileName='+t[l]+'&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName='+t[l].substring(0,t[l].lastIndexOf("."))+'.jpg&fileType=up&th=true"  /></div><div>'+SimpleFileName(t[l])+"</div></a></label>":'<label><a href="/Home/GetFile?fileName='+t[l]+'&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>'+SimpleFileName(t[l])+"</div></a></label>",d&&(r+="</div>"),r+="<span>âœ“</span></li>";$(".loading").hide(),$(".chat-pm-input textarea").val(""),$("#lastchat").before(r),$(".img-tag").unbind("click"),$(".img-tag").on("click",function(){var e=$(this).data("url");loadImageModal(e)}),$("#Files").val(""),$("#pogressbarModal").modal("hide"),i=$(".contact.active").data("id"),console.log("fileUploadCompleted","var isGroup before"),a=$(".contact.active").hasClass("grp"),setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500),replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess(),0<(o=$("#my-progress-bar")).length&&(o.get(0).style.width="100%",setTimeout(function(){o.get(0).style.width="0%",o.attr("aria-valuenow","0"),o.html("0%")},100)),a?mySignalRListener.sendBySignalRToGroup(i,"isfile;;;"+userid+";;;"+e+",;,"+d+";;;;;;"+replyid):mySignalRListener.sendBySignalR(i,"isfile;;;"+userid+";;;"+e+",;,"+d+";;;;;;"+replyid),console.log("fileUploadCompleted","loadForSelectLi before"),loadForSelectLi(),console.log("fileUploadCompleted","end")}catch(e){console.log("fileUploadCompleted err",e)}}function fileUploader(e,l){$(".loading").show();var i=_("fileinput").files[0],a=new FormData;a.append("file1",i),a.append("contactId",l),a.append("replyId",replyid),uploadFile(a)}function LoadProgressBar(o,t){var r=$("#files-progressbar"),d=$(".progress-label");$("#pogressbarModal").modal({backdrop:"static",keyboard:!1}),$("#pogressbarModal").modal("show"),r.show(),$("#files-progressbar").progressbar({change:function(){d.text(r.progressbar("value")+"%")},complete:function(){d.text("Loading Completed!"),r.progressbar("value",0),d.text(""),r.hide();for(var e=o.split(";"),l="",i=(i=$(".message-input .card-header").text())&&i.substring(0,i.length-1),a=0;a<e.length;a++)l+='<li class="from-me">',i&&(l+='<div class="card" data-id="'+(replyid||"")+`" >
                      <div class="card-header">`+i+"</div>"),l+=IsImage(e[a])?'<label><a data-url="/Home/GetFile?fileName='+e[a]+'&fileType=up" class="img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName='+e[a]+'&fileType=up&th=true" /></div><div>'+SimpleFileName(e[a])+"</div></a></label>":IsAudio(e[a])?'<label><div><audio controls src="/Home/GetFile?fileName='+e[a]+'&fileType=up" ></audio></div><div> '+SimpleFileName(e[a])+"</div></label>":IsVideo(e[a])?'<label><div><video controls  ><source src="/Home/GetFile?fileName='+e[a]+'&fileType=up" ></video></div><div> '+SimpleFileName(e[a])+"</div></label>":IsPdfOrDoc(e[a])?'<label><a href="/Home/GetFile?fileName='+e[a]+'&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName='+e[a].substring(0,e[a].lastIndexOf("."))+'.jpg&fileType=up&th=true"  /></div><div>'+SimpleFileName(e[a])+"</div></a></label>":'<label><a href="/Home/GetFile?fileName='+e[a]+'&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>'+SimpleFileName(e[a])+"</div></a>></label>",i&&(l+="</div>"),l+="</li>";$(".loading").hide(),$(".chat-pm-input textarea").val(""),$("#lastchat").before(l),$(".img-tag").unbind("click"),$(".img-tag").on("click",function(){var e=$(this).data("url");loadImageModal(e)}),$("#Files").val(""),$("#pogressbarModal").modal("hide"),mySignalRListener.sendBySignalR(t,"isfile;;;"+userid+";;;"+o+",;,"+i+";;;;;;"+replyid),setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500),replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess()}}),setTimeout(function e(){var l=r.progressbar("value")||0;r.progressbar("value",l+1),l<99&&setTimeout(e,25)},100)}function IsImage(e){e=e.toLowerCase().substring(e.lastIndexOf("."));return!![".jpg",".jpeg",".bmp",".png",".gif",".tiff"].includes(e)}function IsAudio(e){e=e.toLowerCase().substring(e.lastIndexOf("."));return!![".wav",".mp3"].includes(e)}