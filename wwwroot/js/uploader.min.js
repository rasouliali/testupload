function _(e){return document.getElementById(e)}function uploadFile(e){$("#my-progress-bar").html("");var l=new XMLHttpRequest;l.upload.addEventListener("progress",progressHandler,!1),l.addEventListener("load",completeHandler,!1),l.addEventListener("error",errorHandlerUploader,!1),l.addEventListener("abort",abortHandler,!1),l.open("POST","/Home/UploadFiles"),l.send(e)}function progressHandler(e){var e=e.loaded/e.total*100,l=$("#my-progress-bar");0<l.length&&(l.get(0).style.width=Math.round(e)+"%",l.attr("aria-valuenow",Math.round(e)),l.html(Math.round(e)+"%"))}function completeHandler(e){fileUploadCompleted(e)}function errorHandlerUploader(){alertify("Upload Failed!!!")}function abortHandler(){alertify("Upload Aborted!!!")}function fileUploadCompleted(e){var l,a,i,o;try{console.log("fileUploadCompleted","start"),$("#tempProgressBar").remove(),$(".loading").hide(),console.log("fileUploadCompleted","result.target.response.split before"),e=e.target.response.split('"').join(""),console.log("fileUploadCompleted","result.target.response.split after");var t=e.split(";"),r="",s=(s=$(".message-input .card-header").text())&&s.substring(0,s.length-1);for(console.log("fileUploadCompleted","for (var i = 0; i < resArr before"),l=0;l<t.length;l++)r+='<li class="from-me">',s&&(r+='<div class="card" data-id="'+(replyid||"")+`" >
                    <div class="card-header">`+s+"</div>"),r+=IsImage(t[l])?'<label><a data-url="/Home/GetFile?fileName='+t[l]+'&fileType=up" class="js-smartPhoto img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName='+t[l]+'&fileType=up&th=true" /></div><div>'+SimpleFileName(t[l])+"</div></a></label>":IsAudio(t[l])?'<label><div><audio controls src="/Home/GetFile?fileName='+t[l]+'&fileType=up" ></audio></div><div> '+SimpleFileName(t[l])+"</div></label>":IsVideo(t[l])?'<label><div><video controls  ><source src="/Home/GetFile?fileName='+t[l]+'&fileType=up" ></video></div><div> '+SimpleFileName(t[l])+"</div></label>":IsPdfOrDoc(t[l])?'<label><a href="/Home/GetFile?fileName='+t[l]+'&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName='+t[l].substring(0,t[l].lastIndexOf("."))+'.jpg&fileType=up&th=true"  /></div><div>'+SimpleFileName(t[l])+"</div></a></label>":'<label><a href="/Home/GetFile?fileName='+t[l]+'&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>'+SimpleFileName(t[l])+"</div></a></label>",s&&(r+="</div>"),r+="<span>âœ“</span></li>";$(".loading").hide(),$(".chat-pm-input textarea").val(""),$("#lastchat").before(r),new SmartPhoto(".js-smartPhoto:not(.proc)"),$(".js-smartPhoto:not(.proc)").addClass("proc"),$("#Files").val(""),$("#pogressbarModal").modal("hide"),a=$(".contact.active").data("id"),console.log("fileUploadCompleted","var isGroup before"),i=$(".contact.active").hasClass("grp"),setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500),replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess(),0<(o=$("#my-progress-bar")).length&&(o.get(0).style.width="100%",setTimeout(function(){o.get(0).style.width="0%",o.attr("aria-valuenow","0"),o.html("0%")},100)),i?mySignalRListener.sendBySignalRToGroup(a,"isfile;;;"+userid+";;;"+e+",;,"+s+";;;;;;"+replyid):mySignalRListener.sendBySignalR(a,"isfile;;;"+userid+";;;"+e+",;,"+s+";;;;;;"+replyid),console.log("fileUploadCompleted","loadForSelectLi before"),loadForSelectLi(),console.log("fileUploadCompleted","end")}catch(e){console.log("fileUploadCompleted err",e)}}function fileUploader(e,l){$(".loading").show();var a=_("fileinput").files[0],i=new FormData;i.append("file1",a),i.append("contactId",l),i.append("replyId",replyid),uploadFile(i)}function LoadProgressBar(o,t){var r=$("#files-progressbar"),s=$(".progress-label");$("#pogressbarModal").modal({backdrop:"static",keyboard:!1}),$("#pogressbarModal").modal("show"),r.show(),$("#files-progressbar").progressbar({change:function(){s.text(r.progressbar("value")+"%")},complete:function(){s.text("Loading Completed!"),r.progressbar("value",0),s.text(""),r.hide();for(var e=o.split(";"),l="",a=(a=$(".message-input .card-header").text())&&a.substring(0,a.length-1),i=0;i<e.length;i++)l+='<li class="from-me">',a&&(l+='<div class="card" data-id="'+(replyid||"")+`" >
                      <div class="card-header">`+a+"</div>"),l+=IsImage(e[i])?'<label><a href="/Home/GetFile?fileName='+e[i]+'&fileType=up" class="js-smartPhoto img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName='+e[i]+'&fileType=up&th=true" /></div><div>'+SimpleFileName(e[i])+"</div></a></label>":IsAudio(e[i])?'<label><div><audio controls src="/Home/GetFile?fileName='+e[i]+'&fileType=up" ></audio></div><div> '+SimpleFileName(e[i])+"</div></label>":IsVideo(e[i])?'<label><div><video controls  ><source src="/Home/GetFile?fileName='+e[i]+'&fileType=up" ></video></div><div> '+SimpleFileName(e[i])+"</div></label>":IsPdfOrDoc(e[i])?'<label><a href="/Home/GetFile?fileName='+e[i]+'&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName='+e[i].substring(0,e[i].lastIndexOf("."))+'.jpg&fileType=up&th=true"  /></div><div>'+SimpleFileName(e[i])+"</div></a></label>":'<label><a href="/Home/GetFile?fileName='+e[i]+'&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>'+SimpleFileName(e[i])+"</div></a>></label>",a&&(l+="</div>"),l+="</li>";$(".loading").hide(),$(".chat-pm-input textarea").val(""),$("#lastchat").before(l),0<$(".js-smartPhoto:not(.proc)").length&&(new SmartPhoto(".js-smartPhoto:not(.proc)"),$(".js-smartPhoto:not(.proc)").addClass("proc")),$("#Files").val(""),$("#pogressbarModal").modal("hide"),mySignalRListener.sendBySignalR(t,"isfile;;;"+userid+";;;"+o+",;,"+a+";;;;;;"+replyid),setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500),replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess()}}),setTimeout(function e(){var l=r.progressbar("value")||0;r.progressbar("value",l+1),l<99&&setTimeout(e,25)},100)}function IsImage(e){e=e.toLowerCase().substring(e.lastIndexOf("."));return!![".jpg",".jpeg",".bmp",".png",".gif",".tiff"].includes(e)}function IsAudio(e){e=e.toLowerCase().substring(e.lastIndexOf("."));return!![".wav",".mp3"].includes(e)}