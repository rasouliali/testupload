function _(n){return document.getElementById(n)}function uploadFile(n){$("#my-progress-bar").html("");var t=new XMLHttpRequest;t.upload.addEventListener("progress",progressHandler,!1);t.addEventListener("load",completeHandler,!1);t.addEventListener("error",errorHandlerUploader,!1);t.addEventListener("abort",abortHandler,!1);t.open("POST","/Home/UploadFiles");t.send(n)}function progressHandler(n){var i=n.loaded/n.total*100,t=$("#my-progress-bar");t.length>0&&(t.get(0).style.width=Math.round(i)+"%",t.attr("aria-valuenow",Math.round(i)),t.html(Math.round(i)+"%"))}function completeHandler(n){fileUploadCompleted(n)}function errorHandlerUploader(){alertify("Upload Failed!!!")}function abortHandler(){alertify("Upload Aborted!!!")}function fileUploadCompleted(n){var t,e,o,f;$("#tempProgressBar").remove();$(".loading").hide();n=n.target.response.split('"').join("");var i=n.split(";"),u="",r=$(".message-input .card-header").text();for(r&&(r=r.substring(0,r.length-1)),t=0;t<i.length;t++)u+=`<li class="from-me">`,r&&(u+=`<div class="card" data-id="`+(replyid?replyid:"")+`" >
                <div class="card-header">`+r+`</div>`),u+=IsImage(i[t])?`<label><a data-url="/Home/GetFile?fileName=`+i[t]+`&fileType=up" class="img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName=`+i[t]+`&fileType=up&th=true" /></div><div>`+i[t]+`</div></a></label>`:IsAudio(i[t])?`<label><div><audio controls src="/Home/GetFile?fileName=`+i[t]+`&fileType=up" ></audio></div><div> `+i[t]+`</div></label>`:IsVideo(i[t])?`<label><div><video controls  ><source src="/Home/GetFile?fileName=`+i[t]+`&fileType=up" ></video></div><div> `+i[t]+`</div></label>`:IsPdfOrDoc(i[t])?`<label><a href="/Home/GetFile?fileName=`+i[t]+`&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName=`+i[t].substring(0,i[t].lastIndexOf("."))+`.jpg&fileType=up&th=true"  /></div><div>`+i[t]+`</div></a></label>`:`<label><a href="/Home/GetFile?fileName=`+i[t]+`&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>`+i[t]+`</div></a></label>`,r&&(u+=`</div>`),u+=`<span>âœ“</span></li>`;$(".loading").hide();$(".chat-pm-input textarea").val("");$("#lastchat").before(u);$(".img-tag").unbind("click");$(".img-tag").on("click",function(){var n=$(this).data("url");loadImageModal(n)});$("#Files").val("");$("#pogressbarModal").modal("hide");e=$(".contact.active").data("id");o=$(".contact.active").hasClass("grp");o?sendBySignalRToGroup(e,"isfile;;;"+userid+";;;"+n+",;,"+r+";;;;;;"+replyid):sendBySignalR(e,"isfile;;;"+userid+";;;"+n+",;,"+r+";;;;;;"+replyid);setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500);replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess();f=$("#my-progress-bar");f.length>0&&(f.get(0).style.width="100%",setTimeout(function(){f.get(0).style.width="0%";f.attr("aria-valuenow","0");f.html("0%")},100));loadForSelectLi()}function fileUploader(n,t){$(".loading").show();var r=_("fileinput").files[0],i=new FormData;i.append("file1",r);i.append("contactId",t);i.append("replyId",replyid);uploadFile(i)}function LoadProgressBar(n,t){function u(){var n=i.progressbar("value")||0;i.progressbar("value",n+1);n<99&&setTimeout(u,25)}var i=$("#files-progressbar"),r=$(".progress-label");$("#pogressbarModal").modal({backdrop:"static",keyboard:!1});$("#pogressbarModal").modal("show");i.show();$("#files-progressbar").progressbar({change:function(){r.text(i.progressbar("value")+"%")},complete:function(){var u;r.text("Loading Completed!");i.progressbar("value",0);r.text("");i.hide();var f=n.split(";"),o="",e=$(".message-input .card-header").text();for(e&&(e=e.substring(0,e.length-1)),u=0;u<f.length;u++)o+=`<li class="from-me">`,e&&(o+=`<div class="card" data-id="`+(replyid?replyid:"")+`" >
                      <div class="card-header">`+e+`</div>`),o+=IsImage(f[u])?`<label><a data-url="/Home/GetFile?fileName=`+f[u]+`&fileType=up" class="img-tag" ><div><img class="fupload" src="/Home/GetFile?fileName=`+f[u]+`&fileType=up&th=true" /></div><div>`+f[u]+`</div></a></label>`:IsAudio(f[u])?`<label><div><audio controls src="Home/GetFile?fileName=`+f[u]+`&fileType=up" ></audio></div><div> `+f[u]+`</div></label>`:IsVideo(f[u])?`<label><div><video controls  ><source src="/Home/GetFile?fileName=`+f[u]+`&fileType=up" ></video></div><div> `+f[u]+`</div></label>`:IsPdfOrDoc(f[u])?`<label><a href="/Home/GetFile?fileName=`+f[u]+`&fileType=up" target="_blank" ><div><img class="docpdfimg" src="/Home/GetFile?fileName=`+f[u].substring(0,f[u].lastIndexOf("."))+`.jpg&fileType=up&th=true"  /></div><div>`+f[u]+`</div></a></label>`:`<label><a href="/Home/GetFile?fileName=`+f[u]+`&fileType=up" target="_blank" ><div><img src="/img/file-icon.png" class="img-ico" /></div><div>`+f[u]+`</div></a>></label>`,e&&(o+=`</div>`),o+=`</li>`;$(".loading").hide();$(".chat-pm-input textarea").val("");$("#lastchat").before(o);$(".img-tag").unbind("click");$(".img-tag").on("click",function(){var n=$(this).data("url");loadImageModal(n)});$("#Files").val("");$("#pogressbarModal").modal("hide");sendBySignalR(t,"isfile;;;"+userid+";;;"+n+",;,"+e+";;;;;;"+replyid);setTimeout(function(){$(".chat-pm ul").scrollTop($(".chat-pm ul").get(0).scrollHeight)},500);replyid?($(".message-input .card-header span").trigger("click"),replyid=""):allDropDownButtonProcess()}});setTimeout(u,100)}function IsImage(n){var t=n.toLowerCase().substring(n.lastIndexOf("."));return[".jpg",".jpeg",".bmp",".png",".gif",".tiff"].includes(t)?!0:!1}function IsAudio(n){var t=n.toLowerCase().substring(n.lastIndexOf("."));return[".wav",".mp3"].includes(t)?!0:!1}