function initDraw(){view.init();view.draw()}function start(){canvas=document.getElementById("canvas");let n=document.getElementById("img");view=new Viewer(canvas,n);view.draw()}function disableScroll(){scrollTop=window.pageYOffset||document.documentElement.scrollTop;scrollLeft=window.pageXOffset||document.documentElement.scrollLeft;window.onscroll=function(){window.scrollTo(scrollLeft,scrollTop)}}function enableScroll(){window.onscroll=function(){}}!function(n,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.Viewer=t():n.Viewer=t()}(this,function(){return function(n){function t(r){if(i[r])return i[r].exports;var u=i[r]={i:r,l:!1,exports:{}};return n[r].call(u.exports,u,u.exports,t),u.l=!0,u.exports}var i={};return t.m=n,t.c=i,t.d=function(n,i,r){t.o(n,i)||Object.defineProperty(n,i,{enumerable:!0,get:r})},t.r=function(n){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(n,Symbol.toStringTag,{value:"Module"});Object.defineProperty(n,"__esModule",{value:!0})},t.t=function(n,i){var r,u;if((1&i&&(n=t(n)),8&i)||4&i&&"object"==typeof n&&n&&n.__esModule)return n;if(r=Object.create(null),t.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:n}),2&i&&"string"!=typeof n)for(u in n)t.d(r,u,function(t){return n[t]}.bind(null,u));return r},t.n=function(n){var i=n&&n.__esModule?function(){return n.default}:function(){return n};return t.d(i,"a",i),i},t.o=function(n,t){return Object.prototype.hasOwnProperty.call(n,t)},t.p="",t(t.s=11)}([function(n){var t=n.exports="undefined"!=typeof window&&window.Math==Math?window:"undefined"!=typeof self&&self.Math==Math?self:Function("return this")();"number"==typeof __g&&(__g=t)},function(n){var t=n.exports={version:"2.6.12"};"number"==typeof __e&&(__e=t)},function(n,t,i){var r=i(14),u=i(19);n.exports=i(4)?function(n,t,i){return r.f(n,t,u(1,i))}:function(n,t,i){return n[t]=i,n}},function(n){n.exports=function(n){return"object"==typeof n?null!==n:"function"==typeof n}},function(n,t,i){n.exports=!i(5)(function(){return 7!=Object.defineProperty({},"a",{get:function(){return 7}}).a})},function(n){n.exports=function(n){try{return!!n()}catch(n){return!0}}},function(n){var t=0,i=Math.random();n.exports=function(n){return"Symbol(".concat(void 0===n?"":n,")_",(++t+i).toString(36))}},function(n,t,i){var f=i(1),r=i(0),u=r["__core-js_shared__"]||(r["__core-js_shared__"]={});(n.exports=function(n,t){return u[n]||(u[n]=void 0!==t?t:{})})("versions",[]).push({version:f.version,mode:i(23)?"pure":"global",copyright:"Â© 2020 Denis Pushkarev (zloirock.ru)"})},function(n){var t=Math.ceil,i=Math.floor;n.exports=function(n){return isNaN(n=+n)?0:(n>0?i:t)(n)}},function(n){n.exports=function(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function");}},function(n){function t(n,t){for(var i,r=0;r<t.length;r++)i=t[r],i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(n,i.key,i)}n.exports=function(n,i,r){return i&&t(n.prototype,i),r&&t(n,r),n}},function(n,t,i){"use strict";i.r(t);i.d(t,"default",function(){return o});i(12);var r=i(9),u=i.n(r),f=i(10),e=i.n(f),o=function(){function n(t,i){u()(this,n);this.canvas=t;this.image=i;this.originalImg=i;this.ctx=this.canvas.getContext("2d");this.getFitSize=function(){var u=0,f=0,n=this.imageW,t=this.imageH,i=this.cavW,r=this.cavH;return n<i&&t<r?(u=.5*i-.5*n,f=.5*r-.5*t):t/n>r/i?(n=n*r/t,t=r,u=.5*i-.5*n):(t=t*i/n,n=i,f=.5*r-.5*t),{x:u,y:f,w:n,h:t}};this.isNum=function(n){return/^(-?\d+)(\.\d+)?$/.test(n)};this.init()}return e()(n,[{key:"init",value:function(){this.initData();this.initListener()}},{key:"initData",value:function(){var t=this.image,r=t.width,u=t.height,i=this.canvas,f=i.width,e=i.height,n;this.imgScale=1;this.angle=0;this.isVRevert=1;this.isHRevert=1;this.isMove=!1;this.imageW=r;this.imageH=u;this.cavW=f;this.cavH=e;n=this.getFitSize();this.imgX=n.x;this.imgY=n.y;this.image=this.originalImg}},{key:"initListener",value:function(){this.canvas.addEventListener("mousedown",this,!1);this.canvas.addEventListener("touchstart",this,!1);this.canvas.addEventListener("mouseup",this,!1);this.canvas.addEventListener("touchend",this,!1);this.canvas.addEventListener("mouseout",this,!1);this.canvas.addEventListener("mousewheel",this,!1)}},{key:"handleEvent",value:function(n){switch(n.type){case"mousemove":this.mousemove(n);break;case"touchmove":this.touchmove(n);break;case"mousewheel":this.mousewheel(n);break;case"touchend":this.touchend(n);break;case"mouseup":this.mouseup(n);break;case"mousedown":this.mousedown(n);break;case"touchstart":this.touchstart(n);break;case"mouseout":this.mouseout(n)}}},{key:"mouseout",value:function(){this.isMove=!1;this.canvas.style.cursor="default ";this.canvas.removeEventListener("mousemove",this,!1)}},{key:"mousedown",value:function(n){this.mouseDownPos=this.windowToCanvas(n.clientX,n.clientY);this.isMove=!0;this.canvas.style.cursor="move";this.canvas.addEventListener("mousemove",this,!1)}},{key:"touchstart",value:function(n){this.mouseDownPos=this.windowToCanvas(n.touches[0].clientX,n.touches[0].clientY);this.isMove=!0;this.canvas.style.cursor="move";this.canvas.addEventListener("touchmove",this,!1)}},{key:"mouseup",value:function(){this.isMove=!1;this.canvas.style.cursor="default ";this.canvas.removeEventListener("mousemove",this,!1)}},{key:"touchend",value:function(){this.isMove=!1;this.canvas.style.cursor="default ";this.canvas.removeEventListener("touchmove",this,!1)}},{key:"mousemove",value:function(n){var t;if(this.isMove){t=this.mouseDownPos;this.canvas.style.cursor="move";var i=this.windowToCanvas(n.clientX,n.clientY),r=i.x-t.x,u=i.y-t.y;this.mouseDownPos=i;this.imgX+=r;this.imgY+=u;this.draw()}}},{key:"touchmove",value:function(n){var t;if(this.isMove){t=this.mouseDownPos;this.canvas.style.cursor="move";var i=this.windowToCanvas(n.touches[0].clientX,n.touches[0].clientY),r=i.x-t.x,u=i.y-t.y;this.mouseDownPos=i;this.imgX+=r;this.imgY+=u;this.draw()}}},{key:"mousewheel",value:function(n){var t=this.windowToCanvas(n.clientX,n.clientY);(n.wheelDelta?n.wheelDelta:-40*n.deltaY)>0?(this.imgScale*=2,this.imgX=2*this.imgX-t.x,this.imgY=2*this.imgY-t.y):(this.imgScale/=2,this.imgX=.5*this.imgX+.5*t.x,this.imgY=.5*this.imgY+.5*t.y);this.draw()}},{key:"scale",value:function(n){this.isNum(n)&&(this.imgScale*=n,this.draw())}},{key:"setOriginalSize",value:function(){var i=this.getFitSize(),n,t;this.imgScale=this.originalImg.width/i.w;n=this.cavW/2-this.originalImg.width/2;t=this.cavH/2-this.originalImg.height/2;this.imgScale>1?(this.imgX=n*this.imgScale,this.imgY=t*this.imgScale):(this.imgX=n/this.imgScale,this.imgY=t/this.imgScale);this.draw()}},{key:"dstroy",value:function(){this.canvas.removeEventListener("mousedown",this,!1);this.canvas.removeEventListener("mouseout",this,!1);this.canvas.removeEventListener("mousewheel",this,!1);this.canvas.removeEventListener("mouseup",this,!1);this.canvas.removeEventListener("mousemove",this,!1);this.canvas=null;this.image=null}},{key:"windowToCanvas",value:function(n,t){var i=this.canvas.getBoundingClientRect();return{x:n-i.left-(i.width-this.cavW)/2,y:t-i.top-(i.height-this.cavH)/2}}},{key:"clearCanvas",value:function(){this.ctx.clearRect(0,0,this.cavW,this.cavH)}},{key:"renderImage",value:function(n,t,i,r){this.clearCanvas();this.ctx.save();this.ctx.fillStyle="white";this.ctx.fill();this.ctx.translate(n+i/2,t+r/2);this.ctx.rotate(this.angle);this.ctx.scale(this.isHRevert,this.isVRevert);this.ctx.drawImage(this.image,0,0,this.imageW,this.imageH,-i/2,-r/2,i,r);this.ctx.restore()}},{key:"rotate",value:function(n){this.angle+=n;this.draw()}},{key:"vRevert",value:function(){this.isVRevert*=-1;this.draw()}},{key:"hRevert",value:function(){this.isHRevert*=-1;this.draw()}},{key:"draw",value:function(){var n=this.getFitSize();this.renderImage(this.imgX,this.imgY,n.w*this.imgScale,n.h*this.imgScale)}}]),n}()},function(n,t,i){var r=i(13);r(r.P,"Array",{fill:i(26)});i(31)("fill")},function(n,t,i){var u=i(0),f=i(1),o=i(2),s=i(20),e=i(24),r=function(n,t,i){var c,y,h,p,k=n&r.F,v=n&r.G,d=n&r.S,w=n&r.P,g=n&r.B,l=v?u:d?u[t]||(u[t]={}):(u[t]||{}).prototype,a=v?f:f[t]||(f[t]={}),b=a.prototype||(a.prototype={});for(c in v&&(i=t),i)h=((y=!k&&l&&void 0!==l[c])?l:i)[c],p=g&&y?e(h,u):w&&"function"==typeof h?e(Function.call,h):h,l&&s(l,c,h,n&r.U),a[c]!=h&&o(a,c,p),w&&b[c]!=h&&(b[c]=h)};u.core=f;r.F=1;r.G=2;r.S=4;r.P=8;r.B=16;r.W=32;r.U=64;r.R=128;n.exports=r},function(n,t,i){var r=i(15),u=i(16),f=i(18),e=Object.defineProperty;t.f=i(4)?Object.defineProperty:function(n,t,i){if(r(n),t=f(t,!0),r(i),u)try{return e(n,t,i)}catch(n){}if("get"in i||"set"in i)throw TypeError("Accessors not supported!");return"value"in i&&(n[t]=i.value),n}},function(n,t,i){var r=i(3);n.exports=function(n){if(!r(n))throw TypeError(n+" is not an object!");return n}},function(n,t,i){n.exports=!i(4)&&!i(5)(function(){return 7!=Object.defineProperty(i(17)("div"),"a",{get:function(){return 7}}).a})},function(n,t,i){var u=i(3),r=i(0).document,f=u(r)&&u(r.createElement);n.exports=function(n){return f?r.createElement(n):{}}},function(n,t,i){var r=i(3);n.exports=function(n,t){if(!r(n))return n;var i,u;if(t&&"function"==typeof(i=n.toString)&&!r(u=i.call(n))||"function"==typeof(i=n.valueOf)&&!r(u=i.call(n))||!t&&"function"==typeof(i=n.toString)&&!r(u=i.call(n)))return u;throw TypeError("Can't convert object to primitive value");}},function(n){n.exports=function(n,t){return{enumerable:!(1&n),configurable:!(2&n),writable:!(4&n),value:t}}},function(n,t,i){var o=i(0),r=i(2),e=i(21),u=i(6)("src"),f=i(22),s=(""+f).split("toString");i(1).inspectSource=function(n){return f.call(n)};(n.exports=function(n,t,i,f){var h="function"==typeof i;h&&(e(i,"name")||r(i,"name",t));n[t]!==i&&(h&&(e(i,u)||r(i,u,n[t]?""+n[t]:s.join(String(t)))),n===o?n[t]=i:f?n[t]?n[t]=i:r(n,t,i):(delete n[t],r(n,t,i)))})(Function.prototype,"toString",function(){return"function"==typeof this&&this[u]||f.call(this)})},function(n){var t={}.hasOwnProperty;n.exports=function(n,i){return t.call(n,i)}},function(n,t,i){n.exports=i(7)("native-function-to-string",Function.toString)},function(n){n.exports=!1},function(n,t,i){var r=i(25);n.exports=function(n,t,i){if(r(n),void 0===t)return n;switch(i){case 1:return function(i){return n.call(t,i)};case 2:return function(i,r){return n.call(t,i,r)};case 3:return function(i,r,u){return n.call(t,i,r,u)}}return function(){return n.apply(t,arguments)}}},function(n){n.exports=function(n){if("function"!=typeof n)throw TypeError(n+" is not a function!");return n}},function(n,t,i){"use strict";var u=i(27),r=i(29),f=i(30);n.exports=function(n){for(var t=u(this),i=f(t.length),e=arguments.length,o=r(e>1?arguments[1]:void 0,i),s=e>2?arguments[2]:void 0,h=void 0===s?i:r(s,i);h>o;)t[o++]=n;return t}},function(n,t,i){var r=i(28);n.exports=function(n){return Object(r(n))}},function(n){n.exports=function(n){if(null==n)throw TypeError("Can't call method on  "+n);return n}},function(n,t,i){var r=i(8),u=Math.max,f=Math.min;n.exports=function(n,t){return(n=r(n))<0?u(n+t,0):f(n,t)}},function(n,t,i){var r=i(8),u=Math.min;n.exports=function(n){return n>0?u(r(n),9007199254740991):0}},function(n,t,i){var r=i(32)("unscopables"),u=Array.prototype;null==u[r]&&i(2)(u,r,{});n.exports=function(n){u[r][n]=!0}},function(n,t,i){var r=i(7)("wks"),e=i(6),u=i(0).Symbol,f="function"==typeof u;(n.exports=function(n){return r[n]||(r[n]=f&&u[n]||(f?u:e)("Symbol."+n))}).store=r}]).default});let view,canvas;$(window).on("touchstart",function(n){($(n.target).closest("#canvas").length==1||n.target.getAttribute("id")=="canvas")&&disableScroll()});$(window).on("touchend",function(){enableScroll()});